---
fruit_release:                  'bookworm'
create_files:
  - owner:                      'display'
    group:                      'display'
    mode:                       '0644'
    state:                      'touch'
    path:                       '/var/log/mplayerd.log'
  - owner:                      'display'
    group:                      'display'
    mode:                       '0644'
    state:                      'touch'
    path:                       '/var/log/mplayerd.ret'
  - owner:                      'root'
    group:                      'root'
    mode:                       '0755'
    state:                      'directory'
    path:                       '/etc/mpv/scripts'
install_files:
  - owner:                      'root'
    group:                      'root'
    mode:                       '0755'
    src:                        'files/init.d/mplayer'
    dest:                       '/etc/init.d/mplayer'
  - owner:                      'root'
    group:                      'root'
    mode:                       '0755'
    src:                        'files/bin/mplayerd'
    dest:                       '/usr/local/bin/mplayerd'
  - owner:                      'root'
    group:                      'root'
    mode:                       '0644'
    src:                        'files/conf/mpv.conf'
    dest:                       '/etc/mpv/mpv.conf'
  - owner:                      'root'
    group:                      'root'
    mode:                       '0644'
    src:                        'files/conf/inhibit-screensaver.lua'
    dest:                       '/etc/mpv/scripts/inhibit-screensaver.lua'
  - owner:                      'root'
    group:                      'root'
    mode:                       '0644'
    src:                        'files/conf/fruit.gpg'
    dest:                       '/etc/apt/trusted.gpg.d/fruit.gpg'
template_files:
  - owner:                      'root'
    group:                      'root'
    mode:                       '0644'
    src:                        'templates/fruit.list.j2'
    dest:                       '/etc/apt/sources.list.d/fruit.list'
shell_commands:
  - command:                    mkfifo '/mplayer.control'
    creates:                    '/mplayer.control'
install_packages_from_release:  "{{ fruit_release }}"
install_packages:
  - 'mpv'
adjust_files:
  - owner:                      'www-data'
    group:                      'display'
    mode:                       '0640'
    path:                       '/mplayer.control'
enable_services:
  - 'mplayer'
start_services:
  - 'mplayer'
restart_services:
  - 'mplayer'
